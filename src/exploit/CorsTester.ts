import axios from 'axios';

export class CorsTester {
  static async testCors(url: string) {
    console.log(`\nüïµÔ∏è‚Äç‚ôÄÔ∏è [Exploit] Testing CORS policy on ${url}...`);
    
    const maliciousOrigin = 'http://evil-hacker.com';
    
    try {
      const response = await axios.options(url, {
        headers: {
          'Origin': maliciousOrigin,
          'Access-Control-Request-Method': 'GET'
        },
        validateStatus: () => true // Accept all status codes
      });

      const allowedOrigin = response.headers['access-control-allow-origin'];
      
      if (allowedOrigin === '*' || allowedOrigin === maliciousOrigin) {
        console.log(`üîì [Exploit] SUCCESS! server accepted origin: ${allowedOrigin}`);
        console.log(`   This means ${maliciousOrigin} can read data from this API.`);
        return true;
      } else {
        console.log(`üõ°Ô∏è [Exploit] Failed. Server rejected untrusted origin.`);
        return false;
      }
    } catch (error) {
      console.log(`‚ùå [Exploit] Request failed: ${(error as Error).message}`);
      return false;
    }
  }
}
